knit_with_parameters('~/Documents/project/WhiH_motiff/results/notebook.Rmd')
RMfor <- read.csv("~/Documents/courses/stats/Ex_5/RMfor.csv", sep=';')
pairs(~oak+birch+alder+lime, data=RMfor, main="Simple Scatterplot Matrix")
RMfor$oak.birch.prod <- RMfor$oak * RMfor$birch
RMfor$oak.birch.prod <- RMfor$oak * RMfor$birch
RMfor$oak.alder.prod <- RMfor$oak * RMfor$alder
RMfor$birch.alder.prod <- RMfor$alder * RMfor$birch
View(RMfor)
library(Hmisc)
rcorr(RMfor$oak,RMfor$lime, type="pearson")
rcorr(RMfor$birch,RMfor$lime, type="pearson")
rcorr(RMfor$alder,RMfor$lime, type="pearson")
rcorr(RMfor$oak.birch.prod,RMfor$lime, type="pearson")
rcorr(RMfor$oak.alder.prod,RMfor$lime, type="pearson")
rcorr(RMfor$birch.alder.prod,RMfor$lime, type="pearson")
rcorr(as.matrix(RMfor[4:10], type="pearson")
rcorr(as.matrix(RMfor[4:10]), type="pearson")
rcorr(as.matrix(RMfor[4:10]), type="pearson")
library (pcor)
library (ppcor)
install.packages("ppcor")
library (ppcor)
pcor.test(RMfor$lime, RMfor$oak, RMfor$birch, method="pearson")
pcor.test(RMfor$lime, RMfor$oak, RMfor$alder, method="pearson")
pcor.test(RMfor$lime, RMfor$alder, RMfor$birch, method="pearson")
p.values <- rep(NA, 10)
dim(p.values) <- c(5,2)
p.values
oak_alder <- pcor.test(RMfor$lime, RMfor$oak, RMfor$alder, method="pearson")
lim_oak <-  pcor.test(RMfor$lime, RMfor$oak, RMfor$alder, method="pearson")
p.values[1,1] <- "lim_oak"
lim_oak <-  pcor.test(RMfor$lime, RMfor$oak, RMfor$birch, method="pearson")
p.values[1,1] <- "lim_oak"
p.values[1,2] <- lim_oak$p.value
lim_ald <-  pcor.test(RMfor$lime, RMfor$alder, RMfor$birch, method="pearson")
p.values[2,1] <- "lim_ald"
p.values[2,2] <- lim_ald$p.value
lim_oxb <-  pcor.test(RMfor$lime, RMfor$oak.birch.prod, RMfor$birch, method="pearson")
p.values[3,1] <- "lim_oxb"
p.values[3,2] <- lim_oxb$p.value
lim_oxa <-  pcor.test(RMfor$lime, RMfor$oak.alder.prod, RMfor$birch, method="pearson")
p.values[4,1] <- "lim_oxa"
p.values[4,2] <- lim_oxa$p.value
lim_axb <-  pcor.test(RMfor$lime, RMfor$birch.alder.prod, RMfor$birch, method="pearson")
p.values[5,1] <- "lim_axb"
p.values[5,2] <- lim_axb$p.value
p.values
p.values <- rep(NA, 8)
dim(p.values) <- c(4, 2)
p.values <- rep(NA, 8)
dim(p.values) <- c(4, 2)
lim_ald <-  pcor.test(RMfor$lime, RMfor$alder, RMfor[4:5], method="pearson")
p.values[1,1] <- "lim_ald"
p.values[1,2] <- lim_ald$p.value
lim_oxb <-  pcor.test(RMfor$lime, RMfor$oak.birch.prod, RMfor[4:5], method="pearson")
p.values[2,1] <- "lim_oxb"
p.values[2,2] <- lim_oxb$p.value
lim_oxa <-  pcor.test(RMfor$lime, RMfor$oak.alder.prod, RMfor[4:5], method="pearson")
p.values[3,1] <- "lim_oxa"
p.values[3,2] <- lim_oxa$p.value
lim_axb <-  pcor.test(RMfor$lime, RMfor$birch.alder.prod, RMfor[4:5], method="pearson")
p.values[4,1] <- "lim_axb"
p.values[4,2] <- lim_axb$p.value
p.values
p.values <- rep(NA, 6)
dim(p.values) <- c(3, 2)
lim_axb <-  pcor.test(RMfor$lime, RMfor$alder, RMfor[4:6], method="pearson")
p.values[1,1] <- "lim_ald"
p.values[1,2] <- lim_axb$p.value
lim_oxb <-  pcor.test(RMfor$lime, RMfor$oak.birch.prod, RMfor[4:6], method="pearson")
p.values[2,1] <- "lim_oxb"
p.values[2,2] <- lim_oxb$p.value
lim_oxa <-  pcor.test(RMfor$lime, RMfor$oak.alder.prod, RMfor[4:6], method="pearson")
p.values[3,1] <- "lim_oxa"
p.values[3,2] <- lim_oxa$p.value
p.values
lim_axb <-  pcor.test(RMfor$lime, RMfor$alder, RMfor[4:6], method="pearson")
p.values[1,1] <- "lim_axb"
p.values[1,2] <- lim_axb$p.value
lim_oxb <-  pcor.test(RMfor$lime, RMfor$oak.birch.prod, RMfor[4:6], method="pearson")
p.values[2,1] <- "lim_oxb"
p.values[2,2] <- lim_oxb$p.value
lim_oxa <-  pcor.test(RMfor$lime, RMfor$oak.alder.prod, RMfor[4:6], method="pearson")
p.values[3,1] <- "lim_oxa"
p.values[3,2] <- lim_oxa$p.value
p.values
p.values <- rep(NA, 4)
dim(p.values) <- c(2, 2)
lim_oxa <-  pcor.test(RMfor$lime, RMfor$alder, RMfor[4:6], method="pearson")
p.values[1,1] <- "lim_oxa"
p.values[1,2] <- lim_oxa$p.value
lim_oxb <-  pcor.test(RMfor$lime, RMfor$oak.birch.prod, RMfor[4:6], method="pearson")
p.values[2,1] <- "lim_oxb"
p.values[2,2] <- lim_oxb$p.value
p.values
p.values <- rep(NA, 10)
dim(p.values) <- c(5,2)
lim_oak <-  pcor.test(RMfor$lime, RMfor$oak, RMfor$birch, method="pearson")
p.values[1,1] <- "lim_oak"
p.values[1,2] <- lim_oak$p.value
lim_ald <-  pcor.test(RMfor$lime, RMfor$alder, RMfor$birch, method="pearson")
p.values[2,1] <- "lim_ald"
p.values[2,2] <- lim_ald$p.value
lim_oxb <-  pcor.test(RMfor$lime, RMfor$oak.birch.prod, RMfor$birch, method="pearson")
p.values[3,1] <- "lim_oxb"
p.values[3,2] <- lim_oxb$p.value
lim_oxa <-  pcor.test(RMfor$lime, RMfor$oak.alder.prod, RMfor$birch, method="pearson")
p.values[4,1] <- "lim_oxa"
p.values[4,2] <- lim_oxa$p.value
lim_axb <-  pcor.test(RMfor$lime, RMfor$birch.alder.prod, RMfor$birch, method="pearson")
p.values[5,1] <- "lim_axb"
p.values[5,2] <- lim_axb$p.value
p.values
# oak has most significance so we control it in next step
#5 new partial correlation matrix with controlling both birch and oak
p.values2 <- rep(NA, 8)
dim(p.values2) <- c(4, 2)
lim_ald <-  pcor.test(RMfor$lime, RMfor$alder, RMfor[4:5], method="pearson")
p.values2[1,1] <- "lim_ald"
p.values2[1,2] <- lim_ald$p.value
lim_oxb <-  pcor.test(RMfor$lime, RMfor$oak.birch.prod, RMfor[4:5], method="pearson")
p.values2[2,1] <- "lim_oxb"
p.values2[2,2] <- lim_oxb$p.value
lim_oxa <-  pcor.test(RMfor$lime, RMfor$oak.alder.prod, RMfor[4:5], method="pearson")
p.values2[3,1] <- "lim_oxa"
p.values2[3,2] <- lim_oxa$p.value
lim_axb <-  pcor.test(RMfor$lime, RMfor$birch.alder.prod, RMfor[4:5], method="pearson")
p.values2[4,1] <- "lim_axb"
p.values2[4,2] <- lim_axb$p.value
p.values2
#exclude ald now
p.values3 <- rep(NA, 6)
dim(p.values3) <- c(3, 2)
lim_axb <-  pcor.test(RMfor$lime, RMfor$alder, RMfor[4:6], method="pearson")
p.values3[1,1] <- "lim_axb"
p.values3[1,2] <- lim_axb$p.value
lim_oxb <-  pcor.test(RMfor$lime, RMfor$oak.birch.prod, RMfor[4:6], method="pearson")
p.values3[2,1] <- "lim_oxb"
p.values3[2,2] <- lim_oxb$p.value
lim_oxa <-  pcor.test(RMfor$lime, RMfor$oak.alder.prod, RMfor[4:6], method="pearson")
p.values3[3,1] <- "lim_oxa"
p.values3[3,2] <- lim_oxa$p.value
p.values3
full.model <- lm(lime~oak+birch+alder+oak*birch+oak*alder+birch*alder, data=RMfor)
summary(full.model)
install.packages("glmulti")
model.sel <- glmulti(full.model, level = 2, crit='aic')
library(glmulti)
install.packages("glmulti")
library(glmulti)
model.sel <- glmulti(full.model, level = 2, crit='aic')
install.packages(glmulti)
install.packages("glmulti")
library(glmulti)
model.sel <- glmulti(full.model, level = 2, crit='aic')
1076 - 207
756 - 54
fimo <- read.csv('~/2016-11-18/all_peaks/fimo.txt', sep='\t')
fimo <- read.csv('2016-11-18/all_peaks/fimo.txt', sep='\t')
View(fimo)
plot(fimo$score)
plot(log(fimo$score))
plot(fimo$score, line=TRUE)
plot(fimo$score, both=TRUE)
plot(fimo$score, type = 'l')
plot(fimo$p.value, type = 'l')
plot(log(fimo$p.value), type = 'l')
plot(-log(fimo$p.value), type = 'l')
ylab = "-log of p-value", xval = "# of matches")
plot(-log(fimo$p.value), type = 'l', main="-log of p-value vs. index",
ylab = "-log of p-value", xval = "# of matches")
plot(-log(fimo$p.value), type = 'l', main="-log of p-value vs. index",
ylab = "-log of p-value", xlab = "# of matches")
mcast <- read.csv('2016-11-18/all_peaks/mcast.txt', sep='\t')
View(mcast)
match(fimo$start,mcast$start)
na.omit(match(fimo$start,mcast$start))
fimo$mcast <- match(fimo$start,mcast$start)
points(fimo$mcast, col='red')
fimo$logs <- -log(fimo$p.value)
